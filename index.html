<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Leaderboard</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <h1>Welcome to the Game, enter your name to begin!</h1>

    <!-- Name Input Form -->
    <form id="nameForm">
      <label for="playerName">Enter your name:</label>
      <input type="text" id="playerName" required />
      <button type="submit">Start Game</button>
    </form>

    <h2>Leaderboard</h2>
    <div id="leaderboard"></div>

    <script>
      // Store player name in localStorage
      document
        .getElementById("nameForm")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Prevent page reload

          const playerName = document.getElementById("playerName").value;
          if (playerName) {
            localStorage.setItem("playerName", playerName); // Save player name
            window.location.href = "javascript_game/scriptgame.html"; // Redirect to the game page
          }
        });

      async function fetchLeaderboard() {
        try {
          const response = await fetch("./data.json"); // Fetch from your GitHub-hosted file
          const data = await response.json();

          // Sort and display top scores
          const sortedData = data
            .sort((a, b) => b.coins - a.coins) // Sort by coins in descending order
            .slice(0, 5); // Display top 5 players

          const leaderboard = document.getElementById("leaderboard");
          leaderboard.innerHTML = sortedData
            .map(
              (entry) =>
                `<p>${entry.name}: ${entry.coins} coins, ${entry.levels} levels completed</p>`
            )
            .join("");
        } catch (error) {
          console.error("Failed to fetch leaderboard data:", error);
          document.getElementById("leaderboard").innerHTML =
            "<p>Failed to load leaderboard data.</p>";
        }
      }

      // Fetch leaderboard data on page load
      window.onload = fetchLeaderboard;

      // Fetch and display leaderboard on page load
      window.onload = fetchLeaderboard;

      setInterval(fetchLeaderboard, 1000);
    </script>
  </body>
</html>
